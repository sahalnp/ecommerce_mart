    <%- include('../partials/header') %>
    <head>
        <title>Checkout</title>
        <link rel="stylesheet" href="\assets\css\checkout.css">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" />

    </head>
    <main>
        <!-- Hero Area Start-->
        <div class="slider-area">
            <div class="single-slider slider-height2 d-flex align-items-center">
                <div class="container">
                    <div class="row">
                        <div class="col-xl-12">
                            <div class="hero-cap text-center">
                                <h2 class="name">Checkout</h2>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Main Content -->
        <div class="checkout-container pt-5">
            <!-- Left Column -->
            <div class="checkout-main">
                <!-- Shipping Address Section -->
                <div class="section">
                    <div class="section-header">
                        <div class="section-title">1 &nbsp;&nbsp; Choose a shipping address</div>
                    </div>
                <div class="section-content">
                    <% if (addr && addr.length > 0) { %>
                        <% addr.forEach((add, index) => { %>
                            <div class="address-option">
                                <input type="radio" id="address<%= index %>" name="address" value="<%= add._id %>" <%= index === 0 ? "checked" : "" %> >
                                <div class="address-content">
                                    <div class="address-name">
                                        <%= add.addressType %>
                                    </div>
                                    <br>
                                    <div class="address-details">
                                        <%= add.name %><br>
                                        <%= add.number %><br>
                                        <%= add.street %>, <%= add.localPlace %><br>
                                        Near <%= add.landmark %><br>
                                        <%= add.city %>, <%= add.district %>, <%= add.state %> - <%= add.pincode %><br>
                                        <%= add.country %>
                                    </div>
                                </div>
                                    <a href="/address/delete/<%= add._id %>" class="delete-address-link" title="Delete Address" style="margin-left: 8px; color: red;">
                                        <i class="fas fa-trash-alt"></i>
                                    </a>
                                </div>
            <% }); %>
        <% } else { %>
            <div class="address-option">
                <p>No addresses found</p>
            </div>
        <% } %>
        <a href="/add-address" class="add-address-link">+ Add a new address</a>
    </div>
                </div>

                <!-- Payment Method Section -->
        <div class="section">
    <div class="section-header">
        <div class="section-title">2 &nbsp;&nbsp; Choose a payment method</div>
    </div>
    <div class="section-content">

        <!-- Cash on Delivery -->
        <div class="payment-option">
        <input type="radio" id="cod" name="payment" value="cod" checked>
        <label for="cod" class="payment-content">
            <div class="payment-label">Cash on Delivery</div>
            <div class="payment-details">Pay when you receive the product</div>
        </label>
        </div>

        <!-- Razorpay -->
        <div class="payment-option">
        <input type="radio" id="razorpay" name="payment" value="razorpay">
        <label for="razorpay" class="payment-content">
            <div class="payment-label">Razorpay</div>
            <div class="payment-details">Pay securely via UPI, card, net banking.</div>
        </label>
        </div>

    </div>
    </div>

                <!-- Review Items Section -->
                <div class="section">
                    <div class="section-header">
                        <div class="section-title">3 &nbsp;&nbsp; Review items and shipping</div>
                    </div>
                    <div class="section-content">
                        <div class="items-header">
                            <div class="delivery-date" id="delivery-date"></div>
                        </div>

    <% product.forEach((prod) => { %>
    <div class="product-item">
        <div class="product-image">
        <img src="<%= prod.image[0]?.filepath %>" alt="<%= prod.title %>" />
        </div>
        <div class="product-details">
        <div class="product-name">
            <h4><%= prod.title %></h4>
        </div>
        <div class="product-price">
            ₹<%= prod.pricing?.price || 'N/A' %>
        </div>
        <div class="product-options">
            <p>Brand: <%= prod.brandName || 'N/A' %></p>
            <p>Color: <%= prod.bandColour %></p>
            <p>Warranty: <%= prod.warranty %> years</p>
        </div>
        <div class="delivery-info">
            <span class="prime-badge">Prime</span>
            FREE Delivery <%= new Date(Date.now() + 3 * 24 * 60 * 60 * 1000).toDateString() %>
        </div>
        </div>
    </div>
    <% }) %>
                    </div>
                </div>
            </div>

            <!-- Right Column - Order Summary (MOVED HERE) -->
            <div class="checkout-sidebar">
                <div class="place-order-section">
                    <div class="agreement-text">
                        By placing your order, you agree to Amazon's <a href="#">privacy notice</a> and <a href="#">conditions of use</a>.
                    </div>
                </div>
                
                <div class="order-summary">
                    <div class="summary-header">Order Summary</div>
                    <div class="summary-content">
                        <div class="summary-row">
                            <span>Items (<%= product.lenght %>):</span>
                            <span>₹<%= prodtotal %> </span>
                        </div>
                        <div class="summary-row">
                            <span>Shipping & handling:</span>
                             <span><%= ship %></span>
                        </div>
                        <div class="summary-row">
                            <span>Total before tax:</span>
                            <span>₹<%= prodtotal %></span>
                        </div>
                        <div class="summary-row">
                            <span>Estimated tax:</span>
                            <span>10.00</span>
                        </div>
                        <div class="summary-row summary-total">
                            <span>Order total:</span>
                            <span><%= total %></span>
                        </div>
                        <button class="btn-place-order" onclick="placeOrder()">Place your order</button>
                    </div>
                </div>
            </div>
        </div>
    </main>

        <script>
            // Handle payment method selection
            document.querySelectorAll('input[name="payment"]').forEach(radio => {
                radio.addEventListener('change', function() {
                    const cardForm = document.getElementById('cardForm');
                    if (this.value === 'new') {
                        cardForm.classList.add('active');
                    } else {
                        cardForm.classList.remove('active');
                    }
                });
            });
            const deliveryDateElement = document.getElementById("delivery-date");

    const today = new Date();
    today.setDate(today.getDate() + 3); // add 3 days

    const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
    const formattedDate = today.toLocaleDateString('en-US', options);

    deliveryDateElement.textContent = formattedDate;

    function placeOrder() {
        // Add your place order logic here
        alert('Order placed successfully!');
    }
        </script>
    <%- include('../partials/footer') %>