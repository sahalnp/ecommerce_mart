<!DOCTYPE html>
<html class="loading" lang="en" data-textdirection="ltr">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta
            name="viewport"
            content="width=device-width, initial-scale=1.0, user-scalable=0, minimal-ui"
        />
        <meta
            name="description"
            content="Chameleon Admin is a modern Bootstrap 4 webapp &amp; admin dashboard html template with a large number of components, elegant design, clean and organized code."
        />
        <meta
            name="keywords"
            content="admin template, Chameleon admin template, dashboard template, gradient admin template, responsive admin template, webapp, eCommerce dashboard, analytic dashboard"
        />
        <meta name="author" content="ThemeSelect" />
        <title>Chameleon Admin</title>
        <link
            rel="apple-touch-icon"
            href="/theme-assets/images/ico/apple-icon-120.png"
        />
        <link
            rel="shortcut icon"
            type="image/x-icon"
            href="/theme-assets/images/favicon.png"
        />

        <link
            rel="stylesheet"
            href="https://cdnjs.cloudflare.com/ajax/libs/feather-icons/4.28.0/feather.min.css"
        />
        <link
            rel="stylesheet"
            href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
        />

        <link
            href="https://fonts.googleapis.com/css?family=Muli:300,300i,400,400i,600,600i,700,700i%7CComfortaa:300,400,700"
            rel="stylesheet"
        />
        <link
            href="https://maxcdn.icons8.com/fonts/line-awesome/1.1/css/line-awesome.min.css"
            rel="stylesheet"
        />
        <!-- BEGIN VENDOR CSS-->
        <link
            rel="stylesheet"
            type="text/css"
            href="/theme-assets/vendors/css/vendors.css"
        />
        <link
            rel="stylesheet"
            type="text/css"
            href="/theme-assets/vendors/css/charts/chartist.css"
        />
        <!-- END VENDOR CSS-->
        <!-- BEGIN CHAMELEON  CSS-->
        <link
            rel="stylesheet"
            type="text/css"
            href="/theme-assets/vendors/css/app-lite.css"
        />
        <!-- END CHAMELEON  CSS-->
        <!-- BEGIN Page Level CSS-->
        <link
            rel="stylesheet"
            type="text/css"
            href="/theme-assets/vendors/css/core/colors/palette-gradient.css"
        />
        <link
            rel="stylesheet"
            type="text/css"
            href="/theme-assets/vendors/css/core/menu/menu-types/vertical-menu.css"
        />
        <link
            rel="stylesheet"
            type="text/css"
            href="/theme-assets/vendors/css/pages/dashboard-ecommerce.css"
        />
        <!-- END Page Level CSS-->
        <!-- BEGIN Custom CSS-->
        <!-- END Custom CSS-->
    </head>
    <body
        class="vertical-layout vertical-menu 2-columns menu-expanded fixed-navbar"
        data-open="click"
        data-menu="vertical-menu"
        data-color="bg-chartbg"
        data-col="2-columns"
    >
        <!-- fixed-top-->
        <nav
            class="header-navbar navbar-expand-md navbar navbar-with-menu navbar-without-dd-arrow fixed-top navbar-semi-light"
        >
            <div class="navbar-wrapper">
                <div class="navbar-container content">
                    <div
                        class="collapse navbar-collapse show"
                        id="navbar-mobile"
                    >
                        <ul class="nav navbar-nav mr-auto float-left">
                            <li class="nav-item d-block d-md-none">
                                <a
                                    class="nav-link nav-menu-main menu-toggle hidden-xs"
                                    href="#"
                                    ><i class="ft-menu"></i
                                ></a>
                            </li>
                            <li class="nav-item d-none d-md-block">
                                <a class="nav-link nav-link-expand" href="#"
                                    ><i class="ficon ft-maximize"></i
                                ></a>
                            </li>
                            <li class="nav-item dropdown navbar-search">
                                <a
                                    class="nav-link dropdown-toggle hide"
                                    data-toggle="dropdown"
                                    href="#"
                                    ><i class="ficon ft-search"></i
                                ></a>
                                <ul class="dropdown-menu">
                                    <li class="arrow_box">
                                        <form>
                                            <div class="input-group search-box">
                                                <div
                                                    class="position-relative has-icon-right full-width"
                                                >
                                                    <input
                                                        class="form-control"
                                                        id="search"
                                                        type="text"
                                                        placeholder="Search here..."
                                                    />
                                                    <div
                                                        class="form-control-position navbar-search-close"
                                                    >
                                                        <i class="ft-x"> </i>
                                                    </div>
                                                </div>
                                            </div>
                                        </form>
                                    </li>
                                </ul>
                            </li>
                        </ul>
                        <ul class="nav navbar-nav float-right">
                            <li class="dropdown dropdown-language nav-item">
                                <a
                                    class="dropdown-toggle nav-link"
                                    id="dropdown-flag"
                                    href="#"
                                    data-toggle="dropdown"
                                    aria-haspopup="true"
                                    aria-expanded="false"
                                    ><i class="flag-icon flag-icon-us"></i
                                    ><span class="selected-language"></span
                                ></a>
                                <div
                                    class="dropdown-menu"
                                    aria-labelledby="dropdown-flag"
                                ></div>
                            </li>
                        </ul>
                        <ul class="nav navbar-nav float-right">
                            <li class="dropdown dropdown-notification nav-item">
                                <a
                                    class="nav-link nav-link-label"
                                    href="#"
                                    data-toggle="dropdown"
                                    ><i class="ficon ft-mail"> </i
                                ></a>
                            </li>
                            <li class="dropdown dropdown-user nav-item">
                              <a
                                  class="dropdown-toggle nav-link dropdown-user-link"
                                  href="#"
                                  data-toggle="dropdown"
                              >
                                  <span class="avatar avatar-online">
                                      <img
                                          src="/theme-assets\images\gallery\image.png"
                                          alt="User Avatar"
                                          class="default-avatar"
                                      />
                                  </span>
                              </a>
                              <div class="dropdown-menu dropdown-menu-right">
                                  <div class="arrow_box_right">
                                      <a class="dropdown-item" href="#">
                                          <span
                                              class="user-name text-bold-700 ml-1"
                                              ><%= admin.firstname %></span
                                          >
                                      </a>
                                      <div class="dropdown-divider"></div>
                                      <a
                                          class="dropdown-item"
                                          href="/admin/logout"
                                          ><i class="ft-power"></i>Logout</a
                                      >
                                  </div>
                              </div>
                          </li>
                        </ul>
                    </div>
                </div>
            </div>
        </nav>

        <!-- ////////////////////////////////////////////////////////////////////////////-->

        <div
            class="main-menu menu-fixed menu-light menu-accordion menu-shadow"
            data-scroll-to-active="true"
            data-img="/theme-assets/images/backgrounds/02.jpg"
        >
            <div class="navbar-header">
                <ul class="nav navbar-nav flex-row">
                    <li class="nav-item mr-auto">
                        <a class="navbar-brand" href="/admin/dashboard"
                            ><img
                                class="brand-logo"
                                alt="Chameleon admin logo"
                                src="/theme-assets/images/logo/logo.png"
                            />
                            <h3 class="brand-text">Chameleon</h3></a
                        >
                    </li>
                    <li class="nav-item d-md-none">
                        <a class="nav-link close-navbar"
                            ><i class="ft-x"></i
                        ></a>
                    </li>
                </ul>
            </div>
            <div class="main-menu-content">
                <ul
                    class="navigation navigation-main"
                    id="main-menu-navigation"
                    data-menu="menu-navigation"
                >
                    <li class="nav-item">
                        <a href="/admin/dashboard"
                            ><i class="fa fa-home"></i
                            ><span class="menu-title" data-i18n=""
                                >Dashboard</span
                            ></a
                        >
                    </li>
                    <li class="nav-item">
                        <a href="/admin/userDetails">
                            <i class="fas fa-users"></i>
                            <span>Users</span>
                        </a>
                    </li>
                    <li class="nav-item active">
                        <a href="/admin/products">
                            <i class="fas fa-boxes"></i>
                            <span class="menu-title">All Products</span>
                        </a>
                    </li>

                    <li class="nav-item">
                        <a href="/admin/category"
                            ><i class="fas fa-list"></i
                            ><span class="menu-title">Categories</span></a
                        >
                    </li>

                    <li class="nav-item">
                        <a href="/admin/add_product"
                            ><i class="fas fa-plus"></i
                            ><span class="menu-title">Add Product</span></a
                        >
                    </li>
                    <li class="nav-item">
                        <a href="watchlist.html">
                            <i class="fas fa-heart"></i>
                            <span>Watchlist</span>
                        </a>
                    </li>
                </ul>
            </div>
            <div class="navigation-background"></div>
        </div>

        <div class="app-content content">
            <div class="content-overlay"></div>
            <div class="content-wrapper">
              <div class="content-header row">
                <div class="content-header-left col-md-12 mb-2">
                  <h3 class="content-header-title text-dark">All Products</h3>
                </div>
              </div>
          
              <div class="content-body">
                <% if (products.length === 0) { %>
                  <div class="alert alert-info">No products found.</div>
                <% } else { %>
                  <div class="table-responsive">
                    <table class="table table-bordered table-hover text-center align-middle">
                      <thead class="bg-dark text-white">
                        <tr>
                          <th>#</th>
                          <th>Image</th> <!-- New Image column -->
                          <th>Name</th>
                          <th>Price</th>
                          <th>Size</th>
                          <th>Status</th>
                          <th>In Stock</th>
                          <th>Actions</th>
                        </tr>
                      </thead>
                      <tbody>
                        <% products.forEach((product, index) => { %>
                          <tr>
                            <td><%= index + 1 %></td>
          
                            <td>
                              <% if (product.image && product.image.length > 0) { %>
                                <img src="<%= product.image[0] %>" alt="Product Image" style="width: 60px; height: auto; object-fit: contain;">
                              <% } else { %>
                                <span class="text-muted">No Image</span>
                              <% } %>
                            </td>
          
                            <td class="text-dark"><%= product.title %></td>
          
                            <td class="text-dark">
                              ₹<%= product.salePrice
                                ? product.salePrice.toFixed(2)
                                : (product.productPrice ? product.productPrice.toFixed(2) : '0.00') %>
                            </td>
          
                            <td class="text-dark">
                              <% if (Array.isArray(product.size) && product.size.length > 0) { %>
                                <% product.size.forEach(s => { %>
                                  <div><%= s.size.toUpperCase() %> - ₹<%= s.price %></div>
                                <% }) %>
                              <% } else { %>
                                <span class="badge bg-secondary">No size</span>
                              <% } %>
                            </td>
          
                            <td class="text-success">
                              <% if (product.inStock > 0) { %>
                                <span class="text-primary fs-5">Active</span>
                              <% } else { %>
                                <span class="badge text-primary">Out of Stock</span>
                              <% } %>
                            </td>
          
                            <td class="text-dark"><%= product.inStock || 0 %></td>
          
                            <td>
                              <div class="d-flex justify-content-center gap-2">
                                <a href="/admin/edit/<%= product._id %>" class="btn btn-sm btn-outline-primary me-2">
                                  <i class="fas fa-edit"></i>
                                </a>
                                <a href="/admin/delete-product/<%= product._id %>"
                                   class="btn btn-sm btn-outline-danger"
                                   onclick="return confirm('Are you sure you want to delete this product?')">
                                  <i class="fas fa-trash-alt"></i>
                                </a>
                              </div>
                            </td>
                          </tr>
                        <% }) %>
                      </tbody>
                    </table>
                  </div>
                <% } %>
              </div>
            </div>
          </div>
          
        <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
        <script src="/theme-assets/vendors/js/vendors.min.js"></script>
        <script src="/theme-assets/js/core/app-menu-lite.js"></script>
        <script src="/theme-assets/js/core/app-lite.js"></script>
        <%- include('../../partials/footer') %>